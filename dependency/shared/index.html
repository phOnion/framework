<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>In-memory Caching - Onion - Framework</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "In-memory Caching";
    var mkdocs_page_input_path = "dependency\\shared.md";
    var mkdocs_page_url = "/dependency/shared/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Onion - Framework</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Intro</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../setup/">Tutorial</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Dependency</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../invokables/">Invokables</a>
                </li>
                <li class="">
                    
    <a class="" href="../factories/">Factories</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">In-memory Caching</a>
    <ul class="subnav">
            
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../caching/">Persistent Caching</a>
                </li>
                <li class="">
                    
    <a class="" href="../delegation/">Delegation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Routing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../routing/">Introduction</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../hydratable/">Hydration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../collections/">Collections</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../rest/">Rest</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Advanced</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../modules/">Modules</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Onion - Framework</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Dependency &raquo;</li>
        
      
    
    <li>In-memory Caching</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>There is also the root <code>'shared'</code> meta-key that indicates to the container
which resolutions should be cached and return the same instance on every
consequent request made to the container. A good example for this would be
the <code>\PDO</code> or other object that upon instantiation opens a connection to
another remote service. It is supported for both <code>invokable</code> and <code>factories</code>
entries. In those cases you might do something like:</p>
<pre><code class="php">return  [
    'database' =&gt;  [
        'driver' =&gt; 'mysqli',
        'database' =&gt; __DIR__ . '/some.db',
    ],
    'factories' =&gt; [
        \PDO::class =&gt; \My\Pdo\Factory::class,
    ],
    'shared' =&gt; [
        \PDO::class,
    ],
];
</code></pre>

<p>What this will do is upon the first request the PDO object will be created
and if it resolves without any problems the same instance will be used
whenever you request <code>\PDO::class</code> avoiding opening of multiple connections
for every class that is resolved through auto-wiring or requiering always to
keep track of a global connection pool or any other complex technique that
will almost certainly be out of the scope of what you are trying to do (
Except if you are building an ORM, which you shouldn't unless you have a
really good reason to do so, but srsly... please dont &lt;3 ).</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../caching/" class="btn btn-neutral float-right" title="Persistent Caching">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../factories/" class="btn btn-neutral" title="Factories"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../factories/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../caching/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
