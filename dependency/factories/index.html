<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Factories - Onion - Framework</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Factories";
    var mkdocs_page_input_path = "dependency\\factories.md";
    var mkdocs_page_url = "/dependency/factories/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Onion - Framework</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Intro</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../setup/">Tutorial</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Dependency</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../invokables/">Invokables</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Factories</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#basic-factories">Basic factories</a></li>
    

    <li class="toctree-l3"><a href="#abstract-factories">Abstract factories</a></li>
    

    <li class="toctree-l3"><a href="#memory-caching">Memory caching</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../shared/">In-memory Caching</a>
                </li>
                <li class="">
                    
    <a class="" href="../caching/">Persistent Caching</a>
                </li>
                <li class="">
                    
    <a class="" href="../delegation/">Delegation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Routing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../routing/">Introduction</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../hydratable/">Hydration</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../collections/">Collections</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../rest/">Rest</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Advanced</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../modules/">Modules</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Onion - Framework</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Dependency &raquo;</li>
        
      
    
    <li>Factories</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="basic-factories">Basic factories</h2>
<p><code>factories</code> are another essential part of the container. These are manually created classes that
implement <code>\Onion\Framework\Dependency\Interfaces\FactoryInterface</code> and serve as "formulas" how
to build the dependency.</p>
<p>For example:</p>
<pre><code class="php">return  [
    'factories' =&gt;  [
         Framework\Application\Application::class =&gt;
                Framework\Application\Factory\ApplicationFactory::class,
    ]
];
</code></pre>

<p>This tells the container, whenever <code>RouterInterface</code> is requested, to invoke the <code>RouterFactory</code>
which returns an instance of the interface. This is the flexibility point of the container (not an
exclusive feature but still) since it allows you to define manually the way an object instance is
build and also provides an abstraction between the container's resolution and implementation details.
If you use setter injection you will have to use factories, as the container does not provide any
way to auto-wire them. Also setter injected dependencies, could be considered optional and may not
be needed for the class, no need to spend time on them.</p>
<hr />
<h2 id="abstract-factories">Abstract factories</h2>
<p>Abstract factories are aimed to allow the creation of a factory for more
than can determine based on the key what object to return. In general it
is a factory factory as it must return a <code>FactoryInterface</code> which will
return the real object to be injected. For example if an abstract factory
is used to build a cache service an "alias" key can be used like:</p>
<pre><code class="php">// ...
    'factories' =&gt; [
        'cache:redis' =&gt; AbstractCacheFactory::class,
    ],
// ...
</code></pre>

<p>There the abstract factory can switch from which configuration to use
without the need of defining factory for each option.</p>
<p>This could come in handy when dealing with multiple database, cache or
other such backends or multiple servers, where the difference can be
very small (even a single string, like the <code>driver</code> key in db configs).</p>
<p>Abstract factory is defined under the <code>factories</code> key, with the only
just like with any other factory and all is handled transparently for
the application.</p>
<hr />
<h2 id="memory-caching">Memory caching</h2>
<p>And if an object is often required, but does not need to be instantiated multiple times,
there is the <code>shared</code> key. It allows you to define the a list of factory keys that should not
be triggered on every request to the container, but actually "share" the same instance
of the first result. This can be useful in scenarios like, constructing database connection,
instantiating connection to a remote service, etc. The main intent for this is to be used
for heavy objects which might be required on multiple places but sharing the same instance
makes sense.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../shared/" class="btn btn-neutral float-right" title="In-memory Caching">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../invokables/" class="btn btn-neutral" title="Invokables"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../invokables/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../shared/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
